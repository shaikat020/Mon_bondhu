{% extends 'base.html' %}

{% block content %}
<main class="container mx-auto px-4 py-8">
    <div class="glass-morphism p-8 rounded-3xl">
    <div class="content-card" style="background: white; padding: 2rem; border-radius: 15px; margin: 2rem 0;">
        <h2 style="color: #4a5568; margin-bottom: 1rem;">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡¶ø‡¶ï‡¶ü‡¶∏‡ßç‡¶• ‡¶∏‡ßç‡¶¨‡¶æ‡¶∏‡ßç‡¶•‡ßç‡¶Ø ‡¶∏‡ßÅ‡¶¨‡¶ø‡¶ß‡¶æ ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®</h2>
        <p style="color: #464646; margin-bottom: 2rem;">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶è‡¶≤‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶ï‡ßç‡¶≤‡¶ø‡¶®‡¶ø‡¶ï, ‡¶π‡¶æ‡¶∏‡¶™‡¶æ‡¶§‡¶æ‡¶≤, ‡¶´‡¶æ‡¶∞‡ßç‡¶Æ‡ßá‡¶∏‡¶ø ‡¶è‡¶¨‡¶Ç ‡¶ï‡¶Æ‡¶ø‡¶â‡¶®‡¶ø‡¶ü‡¶ø ‡¶∏‡ßç‡¶¨‡¶æ‡¶∏‡ßç‡¶•‡ßç‡¶Ø‡¶ï‡¶∞‡ßç‡¶Æ‡ßÄ ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßá ‡¶¨‡ßá‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®</p>
        
        <!-- Search Form -->
        <div class="search-form-container" style="background: #ffffff; padding: 1.5rem; border-radius: 10px; margin-bottom: 2rem;">
            <form method="GET" style="display: grid; grid-template-columns: 1fr auto; gap: 1rem;">
                <input type="text" name="upazila" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶â‡¶™‡¶ú‡ßá‡¶≤‡¶æ ‡¶¨‡¶æ ‡¶á‡¶â‡¶®‡¶ø‡¶Ø‡¶º‡¶®‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®..." 
                    value="{{ request.GET.upazila }}"
                    style="padding: 1rem; border: 2px solid #718096; border-radius: 10px; color: #2d3748; font-weight: 500; background: #f8fafc; box-shadow: 0 2px 4px rgba(102,126,234,0.1); transition: all 0.3s ease;"
                    class="input-custom">
                <button type="submit" class="btn" style="background: #667eea; color: white;">‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®</button>
            </form>
            
            <div style="margin-top: 1rem; display: flex; gap: 1rem; flex-wrap: wrap;">
                <button type="button" onclick="filterFacilities('all')" class="filter-btn active" style="color: #4c51bf;">‡¶∏‡¶¨</button>
                <button type="button" onclick="filterFacilities('clinic')" class="filter-btn" style="color: #2b6cb0;">‡¶ï‡ßç‡¶≤‡¶ø‡¶®‡¶ø‡¶ï</button>
                <button type="button" onclick="filterFacilities('hospital')" class="filter-btn" style="color: #2c7a7b;">‡¶π‡¶æ‡¶∏‡¶™‡¶æ‡¶§‡¶æ‡¶≤</button>
                <button type="button" onclick="filterFacilities('pharmacy')" class="filter-btn" style="color: #975a16;">‡¶´‡¶æ‡¶∞‡ßç‡¶Æ‡ßá‡¶∏‡¶ø</button>
                <button type="button" onclick="filterFacilities('chw')" class="filter-btn" style="color: #6b46c1;">‡¶∏‡ßç‡¶¨‡¶æ‡¶∏‡ßç‡¶•‡ßç‡¶Ø‡¶ï‡¶∞‡ßç‡¶Æ‡ßÄ</button>
            </div>
        </div>

        <!-- Facilities List -->
        <div id="facilitiesList">
            {% if facilities %}
            <div style="display: grid; gap: 1.5rem;">
                {% for facility in facilities %}
                <div class="facility-card" data-type="{{ facility.facility_type }}">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
                        <div>
                            <h3 style="color: #2d3748; margin-bottom: 0.5rem;">{{ facility.name }}</h3>
                            <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                                <span class="facility-badge {{ facility.facility_type }}">
                                    {% if facility.facility_type == 'clinic' %}üè• ‡¶ï‡ßç‡¶≤‡¶ø‡¶®‡¶ø‡¶ï
                                    {% elif facility.facility_type == 'hospital' %}üè® ‡¶π‡¶æ‡¶∏‡¶™‡¶æ‡¶§‡¶æ‡¶≤
                                    {% elif facility.facility_type == 'pharmacy' %}üíä ‡¶´‡¶æ‡¶∞‡ßç‡¶Æ‡ßá‡¶∏‡¶ø
                                    {% elif facility.facility_type == 'chw' %}üë®‚Äç‚öïÔ∏è ‡¶∏‡ßç‡¶¨‡¶æ‡¶∏‡ßç‡¶•‡ßç‡¶Ø‡¶ï‡¶∞‡ßç‡¶Æ‡ßÄ
                                    {% endif %}
                                </span>
                                <span style="color: #718096;">{{ facility.upazila }}, {{ facility.union }}</span>
                            </div>
                        </div>
                    </div>
                    
                    <div style="color: #4a5568; margin-bottom: 1rem;">
                        <p><strong>‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ:</strong> {{ facility.address }}</p>
                        {% if facility.contact %}
                        <p><strong>‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó:</strong> {{ facility.contact }}</p>
                        {% endif %}
                        {% if facility.hours %}
                        <p><strong>‡¶∏‡¶Æ‡¶Ø‡¶º:</strong> {{ facility.hours }}</p>
                        {% endif %}
                    </div>
                    
                    {% if facility.facility_type == 'chw' %}
                    <div style="background: #e6fffa; padding: 1rem; border-radius: 8px; border-left: 4px solid #38b2ac;">
                        <strong>‡¶∏‡ßá‡¶¨‡¶æ‡¶∏‡¶Æ‡ßÇ‡¶π:</strong> ‡¶Æ‡¶æ‡¶®‡¶∏‡¶ø‡¶ï ‡¶∏‡ßç‡¶¨‡¶æ‡¶∏‡ßç‡¶•‡ßç‡¶Ø ‡¶∏‡¶π‡¶æ‡¶Ø‡¶º‡¶§‡¶æ, ‡¶™‡ßç‡¶∞‡¶æ‡¶•‡¶Æ‡¶ø‡¶ï ‡¶ö‡¶ø‡¶ï‡¶ø‡ßé‡¶∏‡¶æ, ‡¶Æ‡¶æ‡¶§‡ßÉ‡¶∏‡ßç‡¶¨‡¶æ‡¶∏‡ßç‡¶•‡ßç‡¶Ø
                    </div>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div style="text-align: center; padding: 3rem; color: #141414;">
                <div style="font-size: 3rem; margin-bottom: 1rem;">üîç</div>
                <h3>‡¶ï‡ßã‡¶® ‡¶∏‡ßç‡¶¨‡¶æ‡¶∏‡ßç‡¶•‡ßç‡¶Ø ‡¶∏‡ßÅ‡¶¨‡¶ø‡¶ß‡¶æ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø</h3>
                <p>‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶Ö‡¶®‡ßç‡¶Ø ‡¶â‡¶™‡¶ú‡ßá‡¶≤‡¶æ ‡¶¨‡¶æ ‡¶á‡¶â‡¶®‡¶ø‡¶Ø‡¶º‡¶®‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®</p>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- Offline Information -->
    <div style="background: #fff3cd; border: 1px solid #ffeaa7; padding: 1.5rem; border-radius: 10px; margin: 2rem 0;">
        <h4 style="color: #856404; margin-bottom: 1rem;">üì° ‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶® ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶§‡¶•‡ßç‡¶Ø</h4>
        <p style="color: #856404; margin-bottom: 0.5rem;">‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶®‡ßá‡¶ü ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡¶≤‡ßá‡¶ì ‡¶è‡¶á ‡¶§‡¶•‡ßç‡¶Ø ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá‡¶®:</p>
        <ul style="color: #856404; padding-left: 1.5rem;">
            <li>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶è‡¶≤‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶ï‡¶Æ‡¶ø‡¶â‡¶®‡¶ø‡¶ü‡¶ø ‡¶ï‡ßç‡¶≤‡¶ø‡¶®‡¶ø‡¶ï: ‡¶Æ‡¶ô‡ßç‡¶ó‡¶≤ ‡¶ì ‡¶¨‡ßÉ‡¶π‡¶∏‡ßç‡¶™‡¶§‡¶ø‡¶¨‡¶æ‡¶∞ ‡¶∏‡¶ï‡¶æ‡¶≤ ‡ßØ‡¶ü‡¶æ ‡¶•‡ßá‡¶ï‡ßá ‡¶¶‡ßÅ‡¶™‡ßÅ‡¶∞ ‡ßß‡¶ü‡¶æ</li>
            <li>‡¶ú‡¶∞‡ßÅ‡¶∞‡ßÄ ‡¶π‡¶≤‡ßá: ‡¶®‡¶ø‡¶ï‡¶ü‡¶∏‡ßç‡¶• ‡¶â‡¶™‡¶ú‡ßá‡¶≤‡¶æ ‡¶∏‡ßç‡¶¨‡¶æ‡¶∏‡ßç‡¶•‡ßç‡¶Ø ‡¶ï‡¶Æ‡¶™‡ßç‡¶≤‡ßá‡¶ï‡ßç‡¶∏‡ßá ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</li>
            <li>‡¶ï‡¶Æ‡¶ø‡¶â‡¶®‡¶ø‡¶ü‡¶ø ‡¶∏‡ßç‡¶¨‡¶æ‡¶∏‡ßç‡¶•‡ßç‡¶Ø‡¶ï‡¶∞‡ßç‡¶Æ‡ßÄ: ‡¶∏‡ßç‡¶•‡¶æ‡¶®‡ßÄ‡¶Ø‡¶º ‡¶á‡¶â‡¶®‡¶ø‡¶Ø‡¶º‡¶® ‡¶™‡¶∞‡¶ø‡¶∑‡¶¶ ‡¶•‡ßá‡¶ï‡ßá ‡¶™‡¶∞‡¶ø‡¶ö‡¶Ø‡¶º‡¶™‡¶§‡ßç‡¶∞ ‡¶¶‡ßá‡¶ñ‡ßá ‡¶®‡¶ø‡¶®</li>
        </ul>
    </div>
    </div>
    </div>
</main>

<style>
.filter-btn {
    padding: 0.5rem 1rem;
    border: 2px solid #e2e8f0;
    background: white;
    border-radius: 25px;
    cursor: pointer;
    transition: all 0.3s;
}

.filter-btn.active,
.filter-btn:hover {
    background: #667eea;
    color: white;
    border-color: #667eea;
}

/* Base content card */
.content-card {
    background: white;
    padding: 2rem;
    border-radius: 15px;
    margin: 2rem 0;
    transition: all 0.3s ease;
}

.search-form-container {
    background: #ffffff;
    padding: 1.5rem;
    border-radius: 10px;
    margin-bottom: 2rem;
}

/* Dark-mode overrides for this page to ensure high contrast and visibility */
body.dark-mode .content-card {
    background: #1a202c !important;
    border: 1px solid rgba(255,255,255,0.1);
}

body.dark-mode .search-form-container {
    background: #2d3748 !important;
    border: 1px solid rgba(255,255,255,0.08);
}

/* Headings and descriptions with inline color values */
body.dark-mode h2[style*="color: #4a5568"],
body.dark-mode h3[style*="color: #4a5568"] {
    color: #f7fafc !important;
}

body.dark-mode p[style*="color: #464646"],
body.dark-mode p[style*="color: #718096"],
body.dark-mode p[style*="color: #4a5568"] {
    color: #cbd5e1 !important; /* light gray-blue for readability */
}

/* Input field */
body.dark-mode .input-custom {
    background: #111827 !important;
    border-color: #374151 !important;
    color: #f8fafc !important;
}
body.dark-mode .input-custom::placeholder { color: #94a3b8 !important; }
body.dark-mode .input-custom:focus { box-shadow: 0 0 0 3px rgba(76,81,191,0.18) !important; }

/* Filter buttons */
body.dark-mode .filter-btn { background: #0b1220 !important; border-color: #263043 !important; color: #e6eef6 !important; }
body.dark-mode .filter-btn:hover { background: #172033 !important; border-color: #4c51bf !important; }
body.dark-mode .filter-btn.active { background: #4c51bf !important; color: #fff !important; border-color: #4c51bf !important; }

/* Facility cards */
body.dark-mode .facility-card { background: #0b1220 !important; border-color: #263043 !important; color: #e6eef6 !important; }
body.dark-mode .facility-card:hover { box-shadow: 0 6px 18px rgba(2,6,23,0.6) !important; border-color: #4c51bf !important; }
body.dark-mode .facility-card h3[style*="color: #2d3748"] { color: #f8fafc !important; }
body.dark-mode .facility-card p[style*="color: #4a5568"] { color: #cbd5e1 !important; }

/* Facility badges color adjustments for dark mode */
body.dark-mode .facility-badge.clinic { background: #1e3a62 !important; color: #bee3f8 !important; }
body.dark-mode .facility-badge.hospital { background: #143d2b !important; color: #c6f6d5 !important; }
body.dark-mode .facility-badge.pharmacy { background: #5b370f !important; color: #fefcbf !important; }
body.dark-mode .facility-badge.chw { background: #3a2170 !important; color: #e9d8fd !important; }

/* CHW details box */
body.dark-mode div[style*="background: #e6fffa"] { background: #123a3f !important; color: #dff3f0 !important; border-left-color: #0ea5a3 !important; }

/* Offline info */
body.dark-mode div[style*="background: #fff3cd"] { background: #3f2a14 !important; border-color: #7c4b12 !important; }
body.dark-mode div[style*="background: #fff3cd"] h4, body.dark-mode div[style*="background: #fff3cd"] p, body.dark-mode div[style*="background: #fff3cd"] li { color: #ffefc2 !important; }

/* No-results message */
body.dark-mode div[style*="text-align: center; padding: 3rem;"] { color: #cbd5e1 !important; }

/* Make inline-colored spans (location) readable */
body.dark-mode span[style*="color: #718096"] { color: #94a3b8 !important; }

/* Buttons in dark mode */
body.dark-mode .btn[style*="background: #667eea"] { background: #4c51bf !important; color: #fff !important; }

.facility-card {
    background: white;
    padding: 1.5rem;
    border: 2px solid #e2e8f0;
    border-radius: 10px;
    transition: all 0.3s;
}

.facility-card:hover {
    border-color: #667eea;
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.facility-badge {
    padding: 0.25rem 0.75rem;
    border-radius: 15px;
    font-size: 0.875rem;
    font-weight: bold;
}

.facility-badge.clinic { background: #bee3f8; color: #2c5282; }
.facility-badge.hospital { background: #c6f6d5; color: #276749; }
.facility-badge.pharmacy { background: #fefcbf; color: #744210; }
.facility-badge.chw { background: #e9d8fd; color: #553c9a; }

/* Custom input style */
.input-custom {
    transition: all 0.3s ease;
}

.input-custom:focus {
    outline: none;
    border-color: #4c51bf;
    box-shadow: 0 0 0 3px rgba(102,126,234,0.2);
    background: white;
}

.input-custom::placeholder {
    background: linear-gradient(45deg, #667eea, #4c51bf);
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
    opacity: 0.8;
    font-weight: 500;
}

.input-custom:hover {
    border-color: #4c51bf;
    box-shadow: 0 2px 6px rgba(102,126,234,0.2);
}

/* Filter button hover states */
.filter-btn:hover {
    background: #f7fafc;
    transform: translateY(-1px);
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.filter-btn.active {
    background: #667eea !important;
    color: white !important;
    border-color: #667eea;
    box-shadow: 0 2px 4px rgba(102,126,234,0.3);
}
</style>

<script>
function filterFacilities(type) {
    const facilities = document.querySelectorAll('.facility-card');
    const filterBtns = document.querySelectorAll('.filter-btn');
    
    // Update active button
    filterBtns.forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
    
    // Filter facilities
    facilities.forEach(facility => {
        if (type === 'all' || facility.dataset.type === type) {
            facility.style.display = 'block';
        } else {
            facility.style.display = 'none';
        }
    });
}

// Load sample data if no facilities exist
{% if not facilities %}
document.addEventListener('DOMContentLoaded', function() {
    // This would typically come from your backend
    const sampleFacilities = [
        {
            name: "‡¶ö‡¶∞ ‡¶ï‡¶≤‡¶æ‡¶™‡¶æ‡¶°‡¶º‡¶æ ‡¶ï‡¶Æ‡¶ø‡¶â‡¶®‡¶ø‡¶ü‡¶ø ‡¶ï‡ßç‡¶≤‡¶ø‡¶®‡¶ø‡¶ï",
            type: "clinic",
            address: "‡¶ö‡¶∞ ‡¶ï‡¶≤‡¶æ‡¶™‡¶æ‡¶°‡¶º‡¶æ ‡¶¨‡¶æ‡¶ú‡¶æ‡¶∞ ‡¶∏‡¶Ç‡¶≤‡¶ó‡ßç‡¶®",
            upazila: "‡¶ö‡¶∞‡¶´‡ßç‡¶Ø‡¶æ‡¶∂‡¶®",
            union: "‡¶ö‡¶∞ ‡¶ï‡¶≤‡¶æ‡¶™‡¶æ‡¶°‡¶º‡¶æ",
            contact: "‡ß¶‡ßß‡ßÆ‡ßß‡ß®-‡ß©‡ß™‡ß´‡ß¨‡ß≠‡ßÆ",
            hours: "‡¶Æ‡¶ô‡ßç‡¶ó‡¶≤ ‡¶ì ‡¶¨‡ßÉ‡¶π‡¶∏‡ßç‡¶™‡¶§‡¶ø‡¶¨‡¶æ‡¶∞ ‡¶∏‡¶ï‡¶æ‡¶≤ ‡ßØ‡¶ü‡¶æ - ‡¶¶‡ßÅ‡¶™‡ßÅ‡¶∞ ‡ßß‡¶ü‡¶æ"
        },
        {
            name: "‡¶°‡¶æ‡¶É ‡¶ï‡¶∞‡¶ø‡¶Æullah",
            type: "chw", 
            address: "‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ: ‡¶ö‡¶∞ ‡¶ï‡¶≤‡¶æ‡¶™‡¶æ‡¶°‡¶º‡¶æ, ‡¶¨‡¶æ‡ßú‡¶ø ‡¶®‡¶Ç ‡ßß‡ß®",
            upazila: "‡¶ö‡¶∞‡¶´‡ßç‡¶Ø‡¶æ‡¶∂‡¶®",
            union: "‡¶ö‡¶∞ ‡¶ï‡¶≤‡¶æ‡¶™‡¶æ‡¶°‡¶º‡¶æ",
            contact: "‡ß¶‡ßß‡ß≠‡ßß‡ßß-‡ß®‡ß®‡ß©‡ß©‡ß™‡ß™",
            hours: "‡¶∏‡¶ï‡¶æ‡¶≤ ‡ßÆ‡¶ü‡¶æ - ‡¶∞‡¶æ‡¶§ ‡ßÆ‡¶ü‡¶æ"
        }
    ];
    
    // You can implement client-side search with this data
});
{% endif %}
</script>
{% endblock %}